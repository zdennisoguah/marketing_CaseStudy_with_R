---
title: "Capstone_project"
author: "Dennis Oguah"
date: "2023-10-12"
output:
  html_document: default
  pdf_document: default
---

Bellabeat Case Study

About Bellabeat
Bellabeat is a high-tech company that manufactures health-focused smart products. Collecting data on daily activity, sleep, stress, and reproductive health has allowed Bellabeat to empower women with knowledge about their own health and habits. Since it was founded in 2013, Bellabeat has grown rapidly and quickly positioned itself as a tech-driven wellness company for women.

# 1. Ask
Key Stakeholders
Urška Sršen: Cofounder and Chief Creative Officer
Sando Mur: Cofounder and Mathematician
Bellabeat marketing analytics team.

Business Task
Analyze smart device usage data in order to gain insight into how consumers use non-Bellabeat smart devices.

I am applying these insights to the bellbeat app

What are some trends in smart device usage?
How could these trends apply to Bellabeat customers?
How could these trends help influence Bellabeat marketing strategy?

# 2. Prepare
**2.1 Information on Data Source:**
The data is publicly available on [Kaggle](https://www.kaggle.com/datasets/arashnic/fitbit/data): FitBit Fitness Tracker Data and stored in 18 csv files.
Generated by respondents from a distributed survey via Amazon Mechanical Turk between 12 March 2016 to 12 May 2016.
30 FitBit users who consented to the submission of personal tracker data.
Data collected includes and would be focused on

* (1) Daily activit
* (2) hourly calories
* (3) sleep monitoring
+ (4) Intensities
+ (5) steps.


**2.2 Limitations of Data Set:**
Data collected from year 2016. Users' daily activity, fitness and sleeping habits, diet and food consumption may have changed since then, hence data may not be timely or relevant.
Sample size of 30 female FitBit users is not representative of the entire female population.
As data is collected in a survey, hence unable to ascertain the integrity or accuracy of data.

**2.3 Is Data ROCCC?**
A good data source is ROCCC which stands for Reliable, Original, Comprehensive, Current, and Cited.

* Reliable - LOW - Not reliable as it only has 30 respondents
* Original - LOW - Third party provider (Amazon Mechanical Turk)
* Comprehensive - MED - Parameters match most of Bellabeat's products' parameters
* Current - LOW - Data is 5 years old and is not relevant
* Cited - LOW - Data collected from third party, hence unknown


Overall, the dataset is considered bad quality data and it is not recommended to produce business recommendations based on this data but it is what is required for this project.

# 3. Process
# installing packages:
```{r}
library(tidyverse)
library(lubridate)
library(skimr)
library(janitor)
library(ggpubr)
library(ggrepel) 
```
# Import necessary data files and remane them
```{r}
activity <- read.csv("Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
calories <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv")
intensities <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv")
sleep <- read.csv("Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
weight <- read.csv("Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
h_steps <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
```
#check properties of imported data
```{r}
str(activity)
colnames(activity)
head(activity)
```
It's clear activity has the most data and also has data from other datasets merged in
```{r}
str(calories)
head(calories)
```
```{r}
str(intensities)
head(intensities)
```

```{r}
str(sleep)
head(sleep)
```

```{r}
str(h_steps)
head(h_steps)
```

```{r}
str(weight)
head(weight)
```
Basics cleaning:
Now, I'm going to Process, Clean and Organize the dataset for analysis. 

Here are some cleaning steps taken with the data :

  + verifying number of users with distinct ID
  + checking for duplicates and removing duplicates
  + cleaning columns
  + consistency of date and time formats 

# Verifying number of users
```{r}
n_unique(activity$Id)
n_unique(sleep$Id)
n_unique(weight$Id)
n_unique(calories$Id)
n_unique(intensities$Id)
n_unique((h_steps$Id))

```
> As we can see activity, calories, hourly steps and intensities have 33 unique identifiers, sleep has 24 and weight has 8. Weight doesn't have enough participants to provide valuable insight so we would proceed without it.

Now we check and remove duplicates

```{r}
sum(duplicated(activity))
sum(duplicated(calories))
sum(duplicated(sleep))
sum(duplicated(h_steps))
sum(duplicated(intensities))
```
Now we remove duplicates from the sleep data set and confirm it has been removed
```{r}
sleep <- sleep %>%
  distinct() %>%
  drop_na()
sum(duplicated(sleep))
```

+ Clean and rename columns
We ensure column names are using right syntax, format and are all lowercase in all datasets as they will be merged later on.

```{r}
clean_names(activity)
activity<- rename_with(activity, tolower)
clean_names(sleep)
sleep <- rename_with(sleep, tolower)
clean_names(h_steps)
h_steps <- rename_with(h_steps, tolower)
clean_names(calories)
calories <- rename_with(calories, tolower)
clean_names(intensities)
intensities <- rename_with(intensities, tolower)
```
## Consistency of date and time columns

> Now the focus is on cleaning date-time format for activity(changing it from chr to date), sleep, h_steps, calories and intensities since we will merge some of the data frames. Since we can disregard the time on daily_sleep data frame we are using as_date instead as as_datetime

```{r change chr format to date time}
# change all date columns in necessary dataframes to date-time format
activity$activitydate <- as.Date(activity$activitydate, "%m/%d/%Y")
sleep$sleepday <- as.Date(sleep$sleepday, "%m/%d/%Y")
calories$activityhour <- as.Date(calories$activityhour, "%m/%d/%Y")
h_steps$activityhour <- as.Date(h_steps$activityhour, "%m/%d/%Y")
# Intensities : split activity hour column to date and time
#intensities$activityhour <- as.Date(intensities$activityhour, "%m/%d/%Y")
intensities$activityhour=as.POSIXct(intensities$activityhour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
intensities$time <- format(intensities$activityhour, format = "%H:%M:%S")
intensities$date <- format(intensities$activityhour, format = "%m/%d/%y")
```

```{r}
# rename all date-time formatted columns to same name for merging
activity <- activity %>%
  rename(date = activitydate)
sleep <- sleep %>% 
  rename(date = sleepday)
calories <- calories %>%
  rename(date = activityhour)
h_steps <- h_steps %>%
  rename(date = activityhour)
#intensities <- intensities %>%
#  rename(date = activityhour)
```
## perform a check to see if there are any missing (NA) values in the dataframe.
```{r}
# Check sum of empty values in every dataframe:
print("NA values in activity dataframe:")
sum(is.na(activity))
print("NA values in calories dataframe:")
sum(is.na(calories))
print("NA values in sleep dataframe:")
sum(is.na(sleep))
print("NA values in h_steps dataframe:")
sum(is.na(h_steps))
print("NA values in intensities dataframe:")
sum(is.na(intensities))
```
# 4. Analyse phase
As we can see there are no missing values in any of our data frames so we can proceed with the data and check the summary statistics for the data frame
```{r}
print("Summary statistics for activity dataframe:")
activity %>%  
  select(totalsteps,
         totaldistance, lightlyactiveminutes, veryactiveminutes, fairlyactiveminutes, sedentaryminutes, calories) %>%
summary(activity)
print("Summary statistics for calories dataframe:")
summary(calories)
print("Summary statistics for sleep dataframe:")
summary(sleep)
print("Summary statistics for h_steps dataframe:")
summary(h_steps)
print("Summary statistics for intensities dataframe:")
summary(intensities)
```
# key findings from data
+ The average sedentary time is too high. The business needs to find ways to reduce this with smart features.
+ The majority of the participants are lightly active. With a high sedentary time.
+ Participants on the average sleep 1 time for an average of 7 hours daily.
+ On average, participants burned 2,304 calories per day. Average adult woman expend roughly 1,600 to 2,400 calories per day versus 2,000 to 3,000 for adult men.
+ Average total steps per day (which is 7638) is a little bit less than recommended by the CDC. According to the CDC research, taking 8,000 steps per day was associated with a 51% lower risk for all-cause mortality (or death from all causes). And taking 12,000 steps per day was associated with a 65% lower risk compared with taking 4,000 steps


# 5. Share phase 
We will now analyze trends of the users of FitBit using the data of the participants and determine if it can help shape BellaBeat's marketing strategy and answer what trends are available in smart device usage.

+ 5.1 Merge revelant data sets
We merge activity and sleep to see any correlation between variables by using id and date as their primary keys.
```{r}
merge_activity_sleep <- merge(sleep, activity, by=c('id', 'date'))
head(merge_activity_sleep)
```

+ 5.2 Visualizations 
Here we create visualizations and communicate findings based on analysis.

## First we start by visualizing the relationship between steps taken and calories burnt
```{r}
ggplot(data=activity, aes(x=totalsteps, y=calories)) + 
  geom_point() + geom_smooth() + labs(title="Total Steps vs. Calories burnt")
```
+ There is a clear positive correlation between the total steps taken and calories burnt. The more steps participants took, the more calories they burnt.

## now we visualize relationship between time spent in bed and time spent asleep
```{r}
ggplot(data=sleep, aes(x=totalminutesasleep, y=totaltimeinbed)) + 
  geom_point()+ geom_smooth() + labs(title="Total Minutes Asleep vs. Total Time in Bed")
```
+ There is a clear positive correlation between the total time participants spent in bed and the time they spent asleep. bellabeat can use this data to create features that would induce sleep

```{r}
int_new <- intensities %>%
  group_by(time) %>%
  drop_na() %>%
  summarise(mean_total_int = mean(totalintensity))

ggplot(data=int_new, aes(x=time, y=mean_total_int)) + geom_histogram(stat = "identity", fill='darkblue') +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(title="Average Total Intensity vs. Time")
```
> After visualizing Total Intensity hourly, I found out that people are most active between 5 am and 10pm.

Most activity happens between 5 pm and 7 pm - I suppose, that people go to a gym or for a walk after finishing work. We can use this time in the Bellabeat app to remind and motivate users to go for a run or walk.

+ A heat map will show users' activity level at one glance.
```{r}
h_step <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
h_step <- h_step %>% 
  rename(date_time= ActivityHour) %>% 
  mutate(date_time= as.POSIXct(date_time, format="%m/%d/%Y %I:%M:%S %p", tz= Sys.timezone()))

head(h_step)
h_step <- h_step %>% 
  separate(date_time, into= c("date", "time"), sep = " ") %>% 
  mutate(date= ymd (date))

head(h_step)
h_step_weekday <- (h_step)%>%
  mutate(weekday= weekdays(date))%>%
  group_by (weekday,time) %>% 
  summarize(average_steps= mean(StepTotal), .groups = 'drop')

h_step_weekday$weekday <- ordered(h_step_weekday$weekday, 
                                 levels=c("Monday", "Tuesday", "Wednesday","Thursday","Friday", "Saturday", "Sunday"))
                                 
head(h_step_weekday)
```
```{r}
ggplot(h_step_weekday, aes(x= time, y= weekday, 
                           fill= average_steps)) +
  theme(axis.text.x= element_text(angle = 90))+
  labs(title= "Active Time During the Week", 
       x=" ", y=" ",fill = "average\nsteps",
       caption= 'Data Source: Fitabase Data 4.12.16-5.12.16')+
  scale_fill_gradient(low= "white", high="red2")+
  geom_tile(color= "white",lwd =.6,linetype =1)+
  coord_fixed()+
  theme(plot.title= element_text(hjust= 0.5,vjust= 0.8, size=16),
        panel.background= element_blank())
```

Observation: Users start their day later on weekends, and are most active during 11am-1pm on Saturday, and 5-6pm on Wednesday.

## Lets look at the relationship between sedentary minutes and time spent asleep
```{r}
ggplot(data=merge_activity_sleep, aes(x=totalminutesasleep, y=sedentaryminutes)) + 
geom_point(color='darkblue') + geom_smooth() +
  labs(title="Minutes Asleep vs. Sedentary Minutes")
```

+ There negative relationship between Sedentary Minutes and Sleep time. this means that users need to reduce their sedentary time to improve sleep.

# 6. Act phase
> Major Findings:

+ The average daily step count is 7638, which is fewer than the CDC-recommended norm for adults of 8000 steps.
+ A day's worth of inactivity is typically 991 minutes. The majority of users' time is spent not being actively.
+ The number of steps walked each day and the number of calories burnt are positively correlated.
+ The amount of time users spend in bed is directly linked to the amount of time they sleep.
+ Distance and calories burnt are found to be positively correlated.
+ The vast majority of individuals are sleep deprived. They get under the required 8 hours of sleep daily
+ There is a negative correlation between sedentary minutes and sleep. this means the more time users spend being inactive, the less they sleep.
+ Users on the average start their days later on weekends and are most active on saturdays, they are also most active from 5-7pm on weekdays.

> Recommendations:

+ Bellabeat can help consumers become less sedentary by motivating them to engage in more physical activity. Daily step counters and hourly notifications informing them they've been sedentary for too long should be Incorporated into the app to encourage users to move for a set duration every hour

+ Introducing programs and challenges for fitness and health incentives. The reward will come in the form of points, which can then be utilized to get deals on Bellabeat's goods and promotions.

+ Bellabeat can also include mindfulness features that encourage meditation to induce sleep during sedentary minutes and when in bed but not asleep.

+ Analysis suggest that the average amount of sleep is less than what is advised. It is possible that people do not use watches when sleeping since they can be uncomfortable. Bellabeat should promote Bellabeat Leaf more because of its wearability.

